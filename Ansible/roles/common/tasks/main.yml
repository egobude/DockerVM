---

- name: Install common packages
  apt:
    pkg: '{{ item }}'
    state: present
    update_cache: yes
  become: yes
  become_method: sudo
  with_items:
    - language-pack-de
    - curl
    - wget
    - make
    - mod_ssl
    - pcre-devel
    - rsync
    - vim
    - zip
    - unzip
    - bzip2
    - p7zip-full
    - git
    - python-pip
    - htop
    - atop
    - iftop
    - mytop
    - iotop
  tags:
    - common

- name: Disable firewall
  shell: ufw disable
  become: yes
  become_method: sudo
  tags:
    - common

- name: Stop firewall and flush rules
  shell: '{{ item }}'
  become: yes
  become_method: sudo
  with_items:
    - iptables -t nat -F
    - iptables -t nat -X
    - iptables -t mangle -F
    - iptables -t mangle -X
    - iptables -P INPUT ACCEPT
    - iptables -P FORWARD ACCEPT
    - iptables -P OUTPUT ACCEPT
  tags:
    - common

- name: Change /etc/hosts
  template: src=hosts.tpl dest=/etc/hosts
  become: yes
  become_method: sudo
  tags:
    - common
